/*!
 * Bootstrap Context Menu
 * Author: @sydcanem
 * https://github.com/sydcanem/bootstrap-contextmenu
 *
 * Modified by: Kartik Visweswaran, Krajee.com, 2018
 * Included enhancements to support Bootstrap v4.x
 *
 * Inspired by Bootstrap's dropdown plugin.
 * Bootstrap (http://getbootstrap.com).
 *
 * Licensed under MIT
 * ========================================================= */
!function(t){"use strict";var e='[data-toggle="context"]',n=function(e,n){this.$element=t(e),this.before=n.before||this.before,this.onItem=n.onItem||this.onItem,this.scopes=n.scopes||null,n.target&&this.$element.data("target",n.target),this.$dropdownMenu=t(n.target+" > .dropdown-menu"),this.isBs4=n.isBs4,this.showCss=this.isBs4?"show":"open",this.listen()};n.prototype={constructor:n,show:function(e){var n,o,s,i,a={relatedTarget:this,target:e.currentTarget};if(!this.isDisabled()&&(this.closemenu(),this.before.call(this,e,t(e.currentTarget))!==!1))return n=this.getMenu(),o=t.Event("show.bs.context",a),n.trigger(o),s=this.getPosition(e,n),i="li:not(.divider)",n.attr("style","").css(s).addClass(this.showCss).on("click.context.data-api",i,t.proxy(this.onItem,this,t(e.currentTarget))).trigger("shown.bs.context",a),this.isBs4&&this.$dropdownMenu.addClass(this.showCss),t("html").on("click.context.data-api",n.selector,t.proxy(this.closemenu,this)),!1},closemenu:function(e){var n,o,s,i;n=this.getMenu(),n.hasClass(this.showCss)&&(i={relatedTarget:this},o=t.Event("hide.bs.context",i),n.trigger(o),s="li:not(.divider)",n.removeClass(this.showCss).off("click.context.data-api",s).trigger("hidden.bs.context",i),this.isBs4&&this.$dropdownMenu.removeClass(this.showCss),t("html").off("click.context.data-api",n.selector),e&&e.stopPropagation())},keydown:function(t){27!==t.which&&"27"!==t.which||this.closemenu(t)},before:function(){return!0},onItem:function(){return!0},listen:function(){this.$element.on("contextmenu.context.data-api",this.scopes,t.proxy(this.show,this)),t("html").on("click.context.data-api",t.proxy(this.closemenu,this)).on("keydown.context.data-api",t.proxy(this.keydown,this))},destroy:function(){this.$element.off(".context.data-api").removeData("context"),t("html").off(".context.data-api")},isDisabled:function(){return this.$element.hasClass("disabled")||this.$element.attr("disabled")},getMenu:function(){var e,n=this.$element.data("target");return n||(n=this.$element.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),e=t(n),e&&e.length?e:this.$element.find(n)},getPosition:function(e,n){var o,s,i,a=e.clientX,r=e.clientY,c=t(window).width(),h=t(window).height(),l=n.find(".dropdown-menu").outerWidth(),d=n.find(".dropdown-menu").outerHeight(),u={position:"absolute","z-index":9999};return o=r+d>h?{top:r-d+t(window).scrollTop()}:{top:r+t(window).scrollTop()},s=a+l>c&&a-l>0?{left:a-l+t(window).scrollLeft()}:{left:a+t(window).scrollLeft()},i=n.offsetParent().offset(),s.left=s.left-i.left,o.top=o.top-i.top,t.extend(u,o,s)}},t.fn.contextmenu=function(e,o){return this.each(function(){var s=t(this),i=s.data("context"),a="object"==typeof e&&e;i||s.data("context",i=new n(s,a)),"string"==typeof e&&i[e].call(i,o)})},t.fn.contextmenu.Constructor=n,t(document).on("contextmenu.context.data-api",function(){t(e).each(function(){var e=t(this).data("context");e&&e.closemenu()})}).on("contextmenu.context.data-api",e,function(e){t(this).contextmenu("show",e),e.preventDefault(),e.stopPropagation()})}(window.jQuery);